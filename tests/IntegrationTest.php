<?php

declare(strict_types=1);

namespace DSS\Tests;

use DSS\Client;
use DSS\Entity\Document;
use DSS\Entity\Digest;
use DSS\Entity\Digest\DigestAlgorithm;
use DSS\Entity\Signature;
use DSS\Entity\Signature\Algorithm;
use DSS\Entity\Signature\SignatureLevel;
use DSS\Entity\Signature\SignaturePackaging;
use DSS\Entity\Encryption;
use DSS\Entity\Encryption\EncryptionAlgorithm;
use DSS\Entity\Certificate\SigningCertificate;
use DSS\Exception\RuntimeException;
use Carbon\Carbon;
use PHPUnit\Framework\TestCase;


final class IntegrationTest extends TestCase
{
    public function testSign(): void
    {
        $client = new Client();
		
		$client->setUrl(\getenv('DSS_URL'));
		
		$client->authenticate(
			Client::AUTH_HTTP_PASSWORD,
			\getenv('DSS_USER'),
			\getenv('DSS_PASSWORD')
		);
					
		$document = (new Document())
			->setBytes(file_get_contents('./tests/Resource/sample.pdf'))
			->setName('test_name')
			;
		$signingDate = (int)Carbon::now()->valueOf();

		$signature = (new Signature())
			->setAlgorithm(Algorithm::RSA_SHA256)
			->setSignatureLevel(SignatureLevel::PAdES_BASELINE_B)
			->setSignaturePackaging(SignaturePackaging::ENVELOPED)
			->setSigningDate($signingDate)
			->setValue(base64_decode(file_get_contents('./tests/Resource/signature')))
			;
			
		$digest = (new Digest())
			->setAlgorithm(DigestAlgorithm::SHA256)
			;
			
		$encryption = (new Encryption())
			->setAlgorithm(EncryptionAlgorithm::RSA)
			;
			
		$certificate = (new SigningCertificate())
			->setCertificate(base64_decode('MIIC6jCCAdKgAwIBAgIGLtYU17tXMA0GCSqGSIb3DQEBCwUAMDAxGzAZBgNVBAMMElJvb3RTZWxmU2lnbmVkRmFrZTERMA8GA1UECgwIRFNTLXRlc3QwHhcNMTcwNjA4MTEyNjAxWhcNNDcwNzA0MDc1NzI0WjAoMRMwEQYDVQQDDApTaWduZXJGYWtlMREwDwYDVQQKDAhEU1MtdGVzdDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMI3kZhtnipn+iiZHZ9ax8FlfE5Ow/cFwBTfAEb3R1ZQUp6/BQnBt7Oo0JWBtc9qkv7JUDdcBJXPV5QWS5AyMPHpqQ75Hitjsq/Fzu8eHtkKpFizcxGa9BZdkQjh4rSrtO1Kjs0Rd5DQtWSgkeVCCN09kN0ZsZ0ENY+Ip8QxSmyztsStkYXdULqpwz4JEXW9vz64eTbde4vQJ6pjHGarJf1gQNEc2XzhmI/prXLysWNqC7lZg7PUZUTrdegABTUzYCRJ1kWBRPm4qo0LN405c94QQd45a5kTgowHzEgLnAQI28x0M3A59TKC+ieNc6VF1PsTLpUw7PNI2VstX5jAuasCAwEAAaMSMBAwDgYDVR0PAQH/BAQDAgEGMA0GCSqGSIb3DQEBCwUAA4IBAQCK6LGA01TR+rmU8p6yhAi4OkDN2b1dbIL8l8iCMYopLCxx8xqq3ubZCOxqh1X2j6pgWzarb0b/MUix00IoUvNbFOxAW7PBZIKDLnm6LsckRxs1U32sC9d1LOHe3WKBNB6GZALT1ewjh7hSbWjftlmcovq+6eVGA5cvf2u/2+TkKkyHV/NR394nXrdsdpvygwypEtXjetzD7UT93Nuw3xcV8VIftIvHf9LjU7h+UjGmKXG9c15eYr3SzUmv6kyOI0Bvw14PWtsWGl0QdOSRvIBBrP4adCnGTgjgjk9LTcO8B8FKrr+8lHGuc0bp4lIUToiUkGILXsiEeEg9WAqm+XqO'))
			->appendChain(base64_decode('MIIFjDCCBHSgAwIBAgIOcJROb7Ojay4AAAADjhEwDQYJKoZIhvcNAQELBQAwZDELMAkGA1UEBhMCTFQxDTALBgNVBAsTBFJDU0MxLTArBgNVBAoTJFZJIFJlZ2lzdHJ1IGNlbnRyYXMgLSBpLmsuIDEyNDExMDI0NjEXMBUGA1UEAxMOUkNTQyBJc3N1aW5nQ0EwHhcNMjEwNDEzMDkyMDI0WhcNMjMwNDEzMDkyMDI0WjCBlzEyMDAGCSqGSIb3DQEJARYjYmVuZWRpa3Rhcy5ydWthc0ByZWdpc3RydWNlbnRyYXMubHQxCzAJBgNVBAYTAkxUMRkwFwYDVQQDExBCRU5FRElLVEFTIFJVS0FTMQ4wDAYDVQQEEwVSVUtBUzETMBEGA1UEKhMKQkVORURJS1RBUzEUMBIGA1UEBRMLMzg4MDYxNjA0NTgwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCr8EbWvzCoIvxwV6gMevZ48Xcxw0BTgroJ2G8t66+42pkRDkSS0vZDs4GD8EXiYXMHNlGy3v1XIp0Q8uqndJy96trIytOV3792M3G2e2Os/cCPM0yV+0Rt+q28q3dncZLywg0f6OmI76vyv8ZpjFwaa8lML6VHvfkWVWytqPQJUF8fmAkYElnic7KHzVLYoyhFfgUruYSH8haxWF3moELOH86I2lzsR+SsjzbjBR5sXgaz11/SF6j4bAbl8T6bLM42zBPNo36ARrUOYsNba6orJrFc0wvROSrrrAjUKcyNubIF+U6gYTpDn4l8KtlYxNd5f9WzFdCbOPLZ3pN/I3F/AgMBAAGjggIGMIICAjAOBgNVHQ8BAf8EBAMCBsAwHQYDVR0OBBYEFFU9sDQ4ZjMATI5B5zwz1deiXCp7MB8GA1UdIwQYMBaAFKwDHfAGHrV4AQIsOR1iPa63WtyKMDsGA1UdHwQ0MDIwMKAuoCyGKmh0dHA6Ly9jc3AyLnJjc2MubHQvY2RwL1JDU0NfSXNzdWluZ0NBLmNybDB7BggrBgEFBQcBAQRvMG0wMwYIKwYBBQUHMAGGJ2h0dHA6Ly9vY3NwMi5yY3NjLmx0L29jc3ByZXNwb25kZXIucmNzYzA2BggrBgEFBQcwAoYqaHR0cDovL2NzcDIucmNzYy5sdC9haWEvUkNTQ19Jc3N1aW5nQ0EuY3J0MD4GCSsGAQQBgjcVBwQxMC8GJysGAQQBgjcVCIKc7HuEpsAKhOWRDoaTmGOHgtFegWGFjLVAh+TSPAIBZAIBDDAfBgNVHSUEGDAWBgorBgEEAYI3CgMMBggrBgEFBQcDBDBGBgNVHSAEPzA9MDsGCysGAQQBgfE3AQIGMCwwKgYIKwYBBQUHAgEWHmh0dHA6Ly93d3cucmNzYy5sdC9yZXBvc2l0b3J5LzApBgkrBgEEAYI3FQoEHDAaMAwGCisGAQQBgjcKAwwwCgYIKwYBBQUHAwQwIgYIKwYBBQUHAQMEFjAUMAgGBgQAjkYBATAIBgYEAI5GAQQwDQYJKoZIhvcNAQELBQADggEBAD/uYAUkIGOjyDGmwXI5G9D2jZYVRUPHZgoFKx0I1R7QUd0IyM+J84q1WYc3aSdWe/DYDXQ6UaGC06jzsliWZx0umLF6RG7lOExrAYe95LQ5ClgCTqTBg8i7hwF55uxBLrHx3E660iu95YiPD5XfbWM22ZocOyMONIq7oihkPTNMpMzDII7d0pamgLhDM4fKU0f5I1iEIlOlvPg9arJZN5B7zV6KGUyhJTqXxv8I9q+ampKtU5NN+vcgg5zLpP1CwCK0LERuHBVfkktKLybkRs69Mvfgi4hWCw2g6DfRf7GhWIvprrPPFdKxl+QtXe1XxbGB0HZVu0OoqYp92TCrAHA='))
			->appendChain(base64_decode('MIIF1DCCA7ygAwIBAgIOV3P4gmEmfOsAAAAAAAIwDQYJKoZIhvcNAQELBQAwYDELMAkGA1UEBhMCTFQxDTALBgNVBAsTBFJDU0MxLDAqBgNVBAoTI1ZJIFJlZ2lzdHJ1IGNlbnRyYXMtIGkuay4gMTI0MTEwMjQ2MRQwEgYDVQQDEwtSQ1NDIFJvb3RDQTAeFw0xNzA1MjUxNDMwNDNaFw0yNjA1MjUxNDMwNDNaMGQxCzAJBgNVBAYTAkxUMQ0wCwYDVQQLEwRSQ1NDMS0wKwYDVQQKEyRWSSBSZWdpc3RydSBjZW50cmFzIC0gaS5rLiAxMjQxMTAyNDYxFzAVBgNVBAMTDlJDU0MgSXNzdWluZ0NBMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAzkQdY7kAvewDlsQ5Rz1ycYi8fTgG7AyGC1ImlSrKRdd1887hriF2CJk1zE/U3TSWLqsfbFapj+pXFkQnNA9VurtyulxoviN0O4sehSpDKgHl1zb/i/WQB2xe9wN6dJnF/dWUu897FIf6JSTC4Pcgmx9m1RFXeQJXrdNwD2876YNzL2V+uKc90oVIRAXcPE3mmHSVnqzGBfD8nYG9rGXgHjZrU/VW5fTN6nrxYHCR/cAXtAZaWnmHzCUEdG7V7InG0iMWOb6I0w0M/995+FtuVNz+JzH1SnyL9tDsFMPoKPp0E2JGZ5TYhAfJDZHaNPg4GXbyTHNslRtK8ewx5kVLfQIDAQABo4IBhjCCAYIwDgYDVR0PAQH/BAQDAgEGMBAGCSsGAQQBgjcVAQQDAgEAMB0GA1UdDgQWBBSsAx3wBh61eAECLDkdYj2ut1rcijA+BgNVHSAENzA1MDMGBFUdIAAwKzApBggrBgEFBQcCARYdaHR0cDovL3d3dy5yY3NjLmx0L3JlcG9zaXRvcnkwGQYJKwYBBAGCNxQCBAweCgBTAHUAYgBDAEEwDwYDVR0TAQH/BAUwAwEB/zAfBgNVHSMEGDAWgBQaJgFPI/EPoA/cVSE73pO7zP4uHjA4BgNVHR8EMTAvMC2gK6AphidodHRwOi8vY3NwMi5yY3NjLmx0L2NkcC9SQ1NDX1Jvb3RDQS5jcmwweAYIKwYBBQUHAQEEbDBqMDMGCCsGAQUFBzABhidodHRwOi8vb2NzcDIucmNzYy5sdC9vY3NwcmVzcG9uZGVyLnJjc2MwMwYIKwYBBQUHMAKGJ2h0dHA6Ly9jc3AyLnJjc2MubHQvYWlhL1JDU0NfUm9vdENBLmNydDANBgkqhkiG9w0BAQsFAAOCAgEAHT3s2uqWsTYVHTsdJIsrTAylvedy9kxPYeXdV0U7hNxPBCKSEbHXtr+7hfxTPrG/D2w1266IZ5lwE6rIIQN6AG+4ge53ArpSz45ipd0oKJIDQ5rY0gP4hZb/rrP7gdAS5bkCOvnb/oCZJk6WF6L6HvY3Sdv0HP18OrB9+h9enjOvcV7CBPSY1bFTRef8RAGEuXzKlTnbC3oKXsCWLHn5cB72LzSCvt0c8vKkx5+sKdKLZ5BZkZN4OkZmf79g2oOecsuSCv2eY2rrhAj81orBi/r7PJsn0u6i4uV2MVPDF6DRfQ1LH1InKHUOT5i2dezk8BSZTP7S/SabqaQahvPSUvzHX5ZBn3fkPOwIkB0aunCRu5huHBpHQempB38c0N+8i1Z8I9Ne2XmusSb09VbiKht9p6CzPmJREvGS2rZdsOyM7QjDUqNmX+ZYrIvrfcdseBGpx6dOvJc8ee6j3KOk7pweXPjIJMe5jpgSWjzIcKsH9rfuPHfpWIAS2PdTLAIBzvSounB53a9s51zPLNfxgDgojGJeBNJV1M4kuegwSmT1m8ZwZ5Th0BFS62BDHtsPKQA5UPUABZBlbPoosoNDTqk+ToQ/OclZBYaW0hr8ZPo0CAcMrzsHx/TnWajNdWp+pR14hBu4Or3RiMuOgNVdEpyGvUI9+MZvX4LHug4+hfg=" [2]=> string(1924) "MIIFnjCCA4agAwIBAgIQTwAboSS9y4hIvr0/K2LHxTANBgkqhkiG9w0BAQsFADBgMQswCQYDVQQGEwJMVDENMAsGA1UECxMEUkNTQzEsMCoGA1UEChMjVkkgUmVnaXN0cnUgY2VudHJhcy0gaS5rLiAxMjQxMTAyNDYxFDASBgNVBAMTC1JDU0MgUm9vdENBMB4XDTE3MDUyMzA4MzY1MVoXDTQ0MDUyMzA4MzY1MVowYDELMAkGA1UEBhMCTFQxDTALBgNVBAsTBFJDU0MxLDAqBgNVBAoTI1ZJIFJlZ2lzdHJ1IGNlbnRyYXMtIGkuay4gMTI0MTEwMjQ2MRQwEgYDVQQDEwtSQ1NDIFJvb3RDQTCCAiIwDQYJKoZIhvcNAQEBBQADggIPADCCAgoCggIBAM5qqkgKQ5dZxvKs9h3uEtp+Nojn80ib+bhuQ6271xFC1h6daAja6riieuV9PTLPlIDuvz7mTqmeHcdJPycG/Bnvt9iPGZLBQjibTUDLhgG/rZE5jIsfo6tuaKGz03rZbCgDdFtJB8hAoVattUFLJaW5U3OBRmFVBOAns6tQ5B8IsuXzkn6shRzbnfpnejD/7i/yMbODkIKlGerLyu1B6YBirzDQhRw1rSJZGFXWFDiAm5qvigQIxu2Jtb8IFn+xbVsY2TqIxBkXNOJKRcNKoQWJd4TP7CQ/IfBNwrvScwtLq4v3WpBfTBalqE/I6b5yDrzNuAwszoC6BfbkSceebzxQTjoURVSqcChkZHJDGlbFyTNeee94i8OU7yU75TvLU9uzbPueBUL/eTrztTn/zj5jGvsX6708joU4F+QEmtpT4pk5NayYfYWDtaOLCek5+H89kDHDFn7cr78p9EN5pcT9X1vS9ctW89sW1xqs8+Zg/VHTPIxVKBEA1UTOzNGdLeMGasJZy3Qu4oNYZFaf/g4ALU0l8FKLWN5meu/AVD9T3xFtZ7LJLrjCqRacxDSHSe9D+bEQw9gumzDbQyrJj0oDEIN3zjPWFnHOIrAWCMmXs9Up0E0OLEKtLv3X13W+MfrYXye1a70AMM5ynLtAEiCgFkWvLWLGlxldQzhPtPrBAgMBAAGjVDBSMA4GA1UdDwEB/wQEAwIBBjAPBgNVHRMBAf8EBTADAQH/MB0GA1UdDgQWBBQaJgFPI/EPoA/cVSE73pO7zP4uHjAQBgkrBgEEAYI3FQEEAwIBADANBgkqhkiG9w0BAQsFAAOCAgEAqBjnjcUJZw9bjWfX/BKRdS+SRkdTZ161zl+xfw8id4ygK0447bqkbNi6WGfA+7mVIHQIYTYkfiWp7kknSuHRmxVKiskrgoQusG+b4rDQwZbXNDWW3FRfjamDQnEJKFG1Kb2hO7K6fXHPwh+I4BpUjeMRRDKnkPADw/i+crZb4LS8v2s2k46hAaxZUUnIniyIk0Jw1x3nisXDSChpxeXFIdvI72tiFD0vbFP3sRUyPIAUQxbguTkW3YwQ2zltgLL/fpfPTJlbahkYsOdJxH9aBu+J+IgBOLXp1iCXO37GFJUFstj7Zyr47+ojEaft6gfqvWiPs4Msi3O69hvhai50yjkppiH1V3h4WyY/8dA2uvA2Xr6/0rKnT13x1EqNd1fAGHDHphYnuOyC2qPoZPWchUaRoKC1FvuOZRxN9oHbcppDzJkaepfSazafUu91aCxCRohZRNZPkhsFuY8LmtBx0k6hG6yBHAERiRPOLtifVeAe/ngUw0GnTvG7HQi+dQt1bP12z5xlTTceIks1cpj08R/aPxJGRRATeVQzH4pt83si5mc8M3696NOKDQuYC73N9LC+kcIh6wAoThKAktwrowAmwpvbyV36F2cduAatZmFSHJpJWYvbDlShWOKNNzShe43FvNqKqNJYcLFi9rBcwBJ3snaGfy+o1B3RfKfimvA='))
			;

        $response = $client
            ->oneDocument($document)
			->sign($signature, $certificate, $digest, $encryption)
			->getResponse()
		;
    }

	public function testGetDigest(): void
    {
        $client = new Client();
		
		$client->setUrl(\getenv('DSS_URL'));
		
		$client->authenticate(
			Client::AUTH_HTTP_PASSWORD,
			\getenv('DSS_USER'),
			\getenv('DSS_PASSWORD')
		);
		
		$document = (new Document())
			->setBytes(file_get_contents('./tests/Resource/sample.pdf'))
			->setName('test_name')
			;
		$signingDate = (int)Carbon::now()->valueOf();

		$signature = (new Signature())
			->setAlgorithm(Algorithm::RSA_SHA256)
			->setSignatureLevel(SignatureLevel::PAdES_BASELINE_B)
			->setSignaturePackaging(SignaturePackaging::ENVELOPED)
			->setSigningDate($signingDate)
			;
			
		$digest = (new Digest())
			->setAlgorithm(DigestAlgorithm::SHA256)
			;
			
		$encryption = (new Encryption())
			->setAlgorithm(EncryptionAlgorithm::RSA)
			;
			
		$certificate = (new SigningCertificate())
			->setCertificate(base64_decode('MIIC6jCCAdKgAwIBAgIGLtYU17tXMA0GCSqGSIb3DQEBCwUAMDAxGzAZBgNVBAMMElJvb3RTZWxmU2lnbmVkRmFrZTERMA8GA1UECgwIRFNTLXRlc3QwHhcNMTcwNjA4MTEyNjAxWhcNNDcwNzA0MDc1NzI0WjAoMRMwEQYDVQQDDApTaWduZXJGYWtlMREwDwYDVQQKDAhEU1MtdGVzdDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMI3kZhtnipn+iiZHZ9ax8FlfE5Ow/cFwBTfAEb3R1ZQUp6/BQnBt7Oo0JWBtc9qkv7JUDdcBJXPV5QWS5AyMPHpqQ75Hitjsq/Fzu8eHtkKpFizcxGa9BZdkQjh4rSrtO1Kjs0Rd5DQtWSgkeVCCN09kN0ZsZ0ENY+Ip8QxSmyztsStkYXdULqpwz4JEXW9vz64eTbde4vQJ6pjHGarJf1gQNEc2XzhmI/prXLysWNqC7lZg7PUZUTrdegABTUzYCRJ1kWBRPm4qo0LN405c94QQd45a5kTgowHzEgLnAQI28x0M3A59TKC+ieNc6VF1PsTLpUw7PNI2VstX5jAuasCAwEAAaMSMBAwDgYDVR0PAQH/BAQDAgEGMA0GCSqGSIb3DQEBCwUAA4IBAQCK6LGA01TR+rmU8p6yhAi4OkDN2b1dbIL8l8iCMYopLCxx8xqq3ubZCOxqh1X2j6pgWzarb0b/MUix00IoUvNbFOxAW7PBZIKDLnm6LsckRxs1U32sC9d1LOHe3WKBNB6GZALT1ewjh7hSbWjftlmcovq+6eVGA5cvf2u/2+TkKkyHV/NR394nXrdsdpvygwypEtXjetzD7UT93Nuw3xcV8VIftIvHf9LjU7h+UjGmKXG9c15eYr3SzUmv6kyOI0Bvw14PWtsWGl0QdOSRvIBBrP4adCnGTgjgjk9LTcO8B8FKrr+8lHGuc0bp4lIUToiUkGILXsiEeEg9WAqm+XqO'))
			->appendChain(base64_decode('MIIFjDCCBHSgAwIBAgIOcJROb7Ojay4AAAADjhEwDQYJKoZIhvcNAQELBQAwZDELMAkGA1UEBhMCTFQxDTALBgNVBAsTBFJDU0MxLTArBgNVBAoTJFZJIFJlZ2lzdHJ1IGNlbnRyYXMgLSBpLmsuIDEyNDExMDI0NjEXMBUGA1UEAxMOUkNTQyBJc3N1aW5nQ0EwHhcNMjEwNDEzMDkyMDI0WhcNMjMwNDEzMDkyMDI0WjCBlzEyMDAGCSqGSIb3DQEJARYjYmVuZWRpa3Rhcy5ydWthc0ByZWdpc3RydWNlbnRyYXMubHQxCzAJBgNVBAYTAkxUMRkwFwYDVQQDExBCRU5FRElLVEFTIFJVS0FTMQ4wDAYDVQQEEwVSVUtBUzETMBEGA1UEKhMKQkVORURJS1RBUzEUMBIGA1UEBRMLMzg4MDYxNjA0NTgwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCr8EbWvzCoIvxwV6gMevZ48Xcxw0BTgroJ2G8t66+42pkRDkSS0vZDs4GD8EXiYXMHNlGy3v1XIp0Q8uqndJy96trIytOV3792M3G2e2Os/cCPM0yV+0Rt+q28q3dncZLywg0f6OmI76vyv8ZpjFwaa8lML6VHvfkWVWytqPQJUF8fmAkYElnic7KHzVLYoyhFfgUruYSH8haxWF3moELOH86I2lzsR+SsjzbjBR5sXgaz11/SF6j4bAbl8T6bLM42zBPNo36ARrUOYsNba6orJrFc0wvROSrrrAjUKcyNubIF+U6gYTpDn4l8KtlYxNd5f9WzFdCbOPLZ3pN/I3F/AgMBAAGjggIGMIICAjAOBgNVHQ8BAf8EBAMCBsAwHQYDVR0OBBYEFFU9sDQ4ZjMATI5B5zwz1deiXCp7MB8GA1UdIwQYMBaAFKwDHfAGHrV4AQIsOR1iPa63WtyKMDsGA1UdHwQ0MDIwMKAuoCyGKmh0dHA6Ly9jc3AyLnJjc2MubHQvY2RwL1JDU0NfSXNzdWluZ0NBLmNybDB7BggrBgEFBQcBAQRvMG0wMwYIKwYBBQUHMAGGJ2h0dHA6Ly9vY3NwMi5yY3NjLmx0L29jc3ByZXNwb25kZXIucmNzYzA2BggrBgEFBQcwAoYqaHR0cDovL2NzcDIucmNzYy5sdC9haWEvUkNTQ19Jc3N1aW5nQ0EuY3J0MD4GCSsGAQQBgjcVBwQxMC8GJysGAQQBgjcVCIKc7HuEpsAKhOWRDoaTmGOHgtFegWGFjLVAh+TSPAIBZAIBDDAfBgNVHSUEGDAWBgorBgEEAYI3CgMMBggrBgEFBQcDBDBGBgNVHSAEPzA9MDsGCysGAQQBgfE3AQIGMCwwKgYIKwYBBQUHAgEWHmh0dHA6Ly93d3cucmNzYy5sdC9yZXBvc2l0b3J5LzApBgkrBgEEAYI3FQoEHDAaMAwGCisGAQQBgjcKAwwwCgYIKwYBBQUHAwQwIgYIKwYBBQUHAQMEFjAUMAgGBgQAjkYBATAIBgYEAI5GAQQwDQYJKoZIhvcNAQELBQADggEBAD/uYAUkIGOjyDGmwXI5G9D2jZYVRUPHZgoFKx0I1R7QUd0IyM+J84q1WYc3aSdWe/DYDXQ6UaGC06jzsliWZx0umLF6RG7lOExrAYe95LQ5ClgCTqTBg8i7hwF55uxBLrHx3E660iu95YiPD5XfbWM22ZocOyMONIq7oihkPTNMpMzDII7d0pamgLhDM4fKU0f5I1iEIlOlvPg9arJZN5B7zV6KGUyhJTqXxv8I9q+ampKtU5NN+vcgg5zLpP1CwCK0LERuHBVfkktKLybkRs69Mvfgi4hWCw2g6DfRf7GhWIvprrPPFdKxl+QtXe1XxbGB0HZVu0OoqYp92TCrAHA='))
			->appendChain(base64_decode('MIIF1DCCA7ygAwIBAgIOV3P4gmEmfOsAAAAAAAIwDQYJKoZIhvcNAQELBQAwYDELMAkGA1UEBhMCTFQxDTALBgNVBAsTBFJDU0MxLDAqBgNVBAoTI1ZJIFJlZ2lzdHJ1IGNlbnRyYXMtIGkuay4gMTI0MTEwMjQ2MRQwEgYDVQQDEwtSQ1NDIFJvb3RDQTAeFw0xNzA1MjUxNDMwNDNaFw0yNjA1MjUxNDMwNDNaMGQxCzAJBgNVBAYTAkxUMQ0wCwYDVQQLEwRSQ1NDMS0wKwYDVQQKEyRWSSBSZWdpc3RydSBjZW50cmFzIC0gaS5rLiAxMjQxMTAyNDYxFzAVBgNVBAMTDlJDU0MgSXNzdWluZ0NBMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAzkQdY7kAvewDlsQ5Rz1ycYi8fTgG7AyGC1ImlSrKRdd1887hriF2CJk1zE/U3TSWLqsfbFapj+pXFkQnNA9VurtyulxoviN0O4sehSpDKgHl1zb/i/WQB2xe9wN6dJnF/dWUu897FIf6JSTC4Pcgmx9m1RFXeQJXrdNwD2876YNzL2V+uKc90oVIRAXcPE3mmHSVnqzGBfD8nYG9rGXgHjZrU/VW5fTN6nrxYHCR/cAXtAZaWnmHzCUEdG7V7InG0iMWOb6I0w0M/995+FtuVNz+JzH1SnyL9tDsFMPoKPp0E2JGZ5TYhAfJDZHaNPg4GXbyTHNslRtK8ewx5kVLfQIDAQABo4IBhjCCAYIwDgYDVR0PAQH/BAQDAgEGMBAGCSsGAQQBgjcVAQQDAgEAMB0GA1UdDgQWBBSsAx3wBh61eAECLDkdYj2ut1rcijA+BgNVHSAENzA1MDMGBFUdIAAwKzApBggrBgEFBQcCARYdaHR0cDovL3d3dy5yY3NjLmx0L3JlcG9zaXRvcnkwGQYJKwYBBAGCNxQCBAweCgBTAHUAYgBDAEEwDwYDVR0TAQH/BAUwAwEB/zAfBgNVHSMEGDAWgBQaJgFPI/EPoA/cVSE73pO7zP4uHjA4BgNVHR8EMTAvMC2gK6AphidodHRwOi8vY3NwMi5yY3NjLmx0L2NkcC9SQ1NDX1Jvb3RDQS5jcmwweAYIKwYBBQUHAQEEbDBqMDMGCCsGAQUFBzABhidodHRwOi8vb2NzcDIucmNzYy5sdC9vY3NwcmVzcG9uZGVyLnJjc2MwMwYIKwYBBQUHMAKGJ2h0dHA6Ly9jc3AyLnJjc2MubHQvYWlhL1JDU0NfUm9vdENBLmNydDANBgkqhkiG9w0BAQsFAAOCAgEAHT3s2uqWsTYVHTsdJIsrTAylvedy9kxPYeXdV0U7hNxPBCKSEbHXtr+7hfxTPrG/D2w1266IZ5lwE6rIIQN6AG+4ge53ArpSz45ipd0oKJIDQ5rY0gP4hZb/rrP7gdAS5bkCOvnb/oCZJk6WF6L6HvY3Sdv0HP18OrB9+h9enjOvcV7CBPSY1bFTRef8RAGEuXzKlTnbC3oKXsCWLHn5cB72LzSCvt0c8vKkx5+sKdKLZ5BZkZN4OkZmf79g2oOecsuSCv2eY2rrhAj81orBi/r7PJsn0u6i4uV2MVPDF6DRfQ1LH1InKHUOT5i2dezk8BSZTP7S/SabqaQahvPSUvzHX5ZBn3fkPOwIkB0aunCRu5huHBpHQempB38c0N+8i1Z8I9Ne2XmusSb09VbiKht9p6CzPmJREvGS2rZdsOyM7QjDUqNmX+ZYrIvrfcdseBGpx6dOvJc8ee6j3KOk7pweXPjIJMe5jpgSWjzIcKsH9rfuPHfpWIAS2PdTLAIBzvSounB53a9s51zPLNfxgDgojGJeBNJV1M4kuegwSmT1m8ZwZ5Th0BFS62BDHtsPKQA5UPUABZBlbPoosoNDTqk+ToQ/OclZBYaW0hr8ZPo0CAcMrzsHx/TnWajNdWp+pR14hBu4Or3RiMuOgNVdEpyGvUI9+MZvX4LHug4+hfg=" [2]=> string(1924) "MIIFnjCCA4agAwIBAgIQTwAboSS9y4hIvr0/K2LHxTANBgkqhkiG9w0BAQsFADBgMQswCQYDVQQGEwJMVDENMAsGA1UECxMEUkNTQzEsMCoGA1UEChMjVkkgUmVnaXN0cnUgY2VudHJhcy0gaS5rLiAxMjQxMTAyNDYxFDASBgNVBAMTC1JDU0MgUm9vdENBMB4XDTE3MDUyMzA4MzY1MVoXDTQ0MDUyMzA4MzY1MVowYDELMAkGA1UEBhMCTFQxDTALBgNVBAsTBFJDU0MxLDAqBgNVBAoTI1ZJIFJlZ2lzdHJ1IGNlbnRyYXMtIGkuay4gMTI0MTEwMjQ2MRQwEgYDVQQDEwtSQ1NDIFJvb3RDQTCCAiIwDQYJKoZIhvcNAQEBBQADggIPADCCAgoCggIBAM5qqkgKQ5dZxvKs9h3uEtp+Nojn80ib+bhuQ6271xFC1h6daAja6riieuV9PTLPlIDuvz7mTqmeHcdJPycG/Bnvt9iPGZLBQjibTUDLhgG/rZE5jIsfo6tuaKGz03rZbCgDdFtJB8hAoVattUFLJaW5U3OBRmFVBOAns6tQ5B8IsuXzkn6shRzbnfpnejD/7i/yMbODkIKlGerLyu1B6YBirzDQhRw1rSJZGFXWFDiAm5qvigQIxu2Jtb8IFn+xbVsY2TqIxBkXNOJKRcNKoQWJd4TP7CQ/IfBNwrvScwtLq4v3WpBfTBalqE/I6b5yDrzNuAwszoC6BfbkSceebzxQTjoURVSqcChkZHJDGlbFyTNeee94i8OU7yU75TvLU9uzbPueBUL/eTrztTn/zj5jGvsX6708joU4F+QEmtpT4pk5NayYfYWDtaOLCek5+H89kDHDFn7cr78p9EN5pcT9X1vS9ctW89sW1xqs8+Zg/VHTPIxVKBEA1UTOzNGdLeMGasJZy3Qu4oNYZFaf/g4ALU0l8FKLWN5meu/AVD9T3xFtZ7LJLrjCqRacxDSHSe9D+bEQw9gumzDbQyrJj0oDEIN3zjPWFnHOIrAWCMmXs9Up0E0OLEKtLv3X13W+MfrYXye1a70AMM5ynLtAEiCgFkWvLWLGlxldQzhPtPrBAgMBAAGjVDBSMA4GA1UdDwEB/wQEAwIBBjAPBgNVHRMBAf8EBTADAQH/MB0GA1UdDgQWBBQaJgFPI/EPoA/cVSE73pO7zP4uHjAQBgkrBgEEAYI3FQEEAwIBADANBgkqhkiG9w0BAQsFAAOCAgEAqBjnjcUJZw9bjWfX/BKRdS+SRkdTZ161zl+xfw8id4ygK0447bqkbNi6WGfA+7mVIHQIYTYkfiWp7kknSuHRmxVKiskrgoQusG+b4rDQwZbXNDWW3FRfjamDQnEJKFG1Kb2hO7K6fXHPwh+I4BpUjeMRRDKnkPADw/i+crZb4LS8v2s2k46hAaxZUUnIniyIk0Jw1x3nisXDSChpxeXFIdvI72tiFD0vbFP3sRUyPIAUQxbguTkW3YwQ2zltgLL/fpfPTJlbahkYsOdJxH9aBu+J+IgBOLXp1iCXO37GFJUFstj7Zyr47+ojEaft6gfqvWiPs4Msi3O69hvhai50yjkppiH1V3h4WyY/8dA2uvA2Xr6/0rKnT13x1EqNd1fAGHDHphYnuOyC2qPoZPWchUaRoKC1FvuOZRxN9oHbcppDzJkaepfSazafUu91aCxCRohZRNZPkhsFuY8LmtBx0k6hG6yBHAERiRPOLtifVeAe/ngUw0GnTvG7HQi+dQt1bP12z5xlTTceIks1cpj08R/aPxJGRRATeVQzH4pt83si5mc8M3696NOKDQuYC73N9LC+kcIh6wAoThKAktwrowAmwpvbyV36F2cduAatZmFSHJpJWYvbDlShWOKNNzShe43FvNqKqNJYcLFi9rBcwBJ3snaGfy+o1B3RfKfimvA='))
			;

        $response = $client
            ->oneDocument($document)
			->getDigest($signature, $certificate, $digest, $encryption)
			->getResponse()
			;
    }
	/*
	public function testGetDigestAndSign(): void
    {
        $client = new Client();
		
		$document = (new Document())
			->setBytes(file_get_contents('./tests/Resource/sample.pdf'))
			->setName('test_name')
			;
		
		$signature = (new Signature())
			->setAlgorithm(new RsaSha256())
			->setSignatureLevel(new PadesBaselineB())
			;
			
		$certificate = (new SigningCertificate())
			->setCertificate('MIIC6jCCAdKgAwIBAgIGLtYU17tXMA0GCSqGSIb3DQEBCwUAMDAxGzAZBgNVBAMMElJvb3RTZWxmU2lnbmVkRmFrZTERMA8GA1UECgwIRFNTLXRlc3QwHhcNMTcwNjA4MTEyNjAxWhcNNDcwNzA0MDc1NzI0WjAoMRMwEQYDVQQDDApTaWduZXJGYWtlMREwDwYDVQQKDAhEU1MtdGVzdDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMI3kZhtnipn+iiZHZ9ax8FlfE5Ow/cFwBTfAEb3R1ZQUp6/BQnBt7Oo0JWBtc9qkv7JUDdcBJXPV5QWS5AyMPHpqQ75Hitjsq/Fzu8eHtkKpFizcxGa9BZdkQjh4rSrtO1Kjs0Rd5DQtWSgkeVCCN09kN0ZsZ0ENY+Ip8QxSmyztsStkYXdULqpwz4JEXW9vz64eTbde4vQJ6pjHGarJf1gQNEc2XzhmI/prXLysWNqC7lZg7PUZUTrdegABTUzYCRJ1kWBRPm4qo0LN405c94QQd45a5kTgowHzEgLnAQI28x0M3A59TKC+ieNc6VF1PsTLpUw7PNI2VstX5jAuasCAwEAAaMSMBAwDgYDVR0PAQH/BAQDAgEGMA0GCSqGSIb3DQEBCwUAA4IBAQCK6LGA01TR+rmU8p6yhAi4OkDN2b1dbIL8l8iCMYopLCxx8xqq3ubZCOxqh1X2j6pgWzarb0b/MUix00IoUvNbFOxAW7PBZIKDLnm6LsckRxs1U32sC9d1LOHe3WKBNB6GZALT1ewjh7hSbWjftlmcovq+6eVGA5cvf2u/2+TkKkyHV/NR394nXrdsdpvygwypEtXjetzD7UT93Nuw3xcV8VIftIvHf9LjU7h+UjGmKXG9c15eYr3SzUmv6kyOI0Bvw14PWtsWGl0QdOSRvIBBrP4adCnGTgjgjk9LTcO8B8FKrr+8lHGuc0bp4lIUToiUkGILXsiEeEg9WAqm+XqO')
			;

        $response = $client
            ->oneDocument($document)
			->getDigest($signature, $certificate)
			->prepareDigestToSign()
			->sign()
			->getResponse()
		;
		
		file_put_contents('./tests/Resource/signed_sample.pdf', $response->getBytes());
		
	
    }*/
    /*
    public function testValidateCertificate(): void
    {
       $client = new Client();
        
        $certificate = (new SigningCertificate())
            ->setCertificate(base64_decode('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'))
            ;

        $response = $client
            ->certificate($certificate)
            ->validate()
            ->getResponse()
        ;
        
        //var_dump($response);
    }*/
}
